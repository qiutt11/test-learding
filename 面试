一、用例有写，但是仍然遗漏了
分析出现原因，例如是否线上数据量问题引入，或是后期开发修改Bug引入，未模拟真实用户行为模式
可以搭建影子数据库，同步生产数据（脱敏）
拦截生产流量，复制到测试环境
bug修改后确认回归测试范围

二、印象深刻的bug
用户反馈支付成功，订单消失 （财务队长，支付成功数>订单创建数）
查看服务日志都返回的200
支付日志都显示的成功
数据库确实缺少部分订单。redis缓存和数据库一致
消息队列没有丢失数据
问题出现在访问高峰期

1、通过traceID发现，部分订单创建请求时间异常的长
2、这些长时间的请求最终日志都显示成功
3、对比数据库的binlog，确实没有这些数据的插入记录
4、应用日志和数据库日志时间差，，应用记录成功时间早于数据库实际写入时间
怀疑是成功幻觉：应用认为成功了但是数据库实际未写入

直接原因是：数据库insert超时，但是事务没有正确回滚
模拟生产压力测试发现
1\数据库连接池接近满载时，出现同样现象
2\数据库执行insert语句超时（默认30s）
3\但是超时后没有正确回滚
4、应用层catch了异常，但是错误处理逻辑有问题

直接原因是：数据库insert超时，但是事务没有正确回滚
技术原因：
--在catch块中处理了异常，事务不会自动回滚
--返回了非NULL值，调用方认为成功了

数据库层：
--mysql在连接池满载时，会先返回成功应答
--但是实际执行被排队，最终可能会超时失败
--应用收到了成功响应，但是数据没有写入




